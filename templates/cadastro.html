<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro - 1XBET</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

    <div class="logo-container">
        <img src="{{ url_for('static', filename='imagens/1xBet_Logo_rgb.png') }}" alt="1XBET Logo" class="logo">
    </div>

    <div class="text-container">
        <h2 class="form-title">
            FILL IN YOUR DETAILS BELOW<br>
            FOR A CHANCE TO WIN<br>
            EXCLUSIVE PRIZES EVERY<br>
            DAY AT SAGSE, IN THE 1XBET SPACE!
        </h2>

        <h3 class="form-subtitle">
            <span class="english-text">Rellena tus datos abajo y participa para tener la oportunidad de ganar </span><br> 
            <span class="english-text">premios exclusivos todos los d√≠as en SAGSE, en el espacio de 1XBET!</span>
        </h3>
    </div>

    <form class="form-container" id="form">
        <div class="input-container">
            <input type="text" id="nome" name="nome" placeholder="Nombre Completo / Full Name:" required>
        </div>
        
        <div class="input-container">
            <input type="text" id="empresa" name="empresa" placeholder="Empresa/Company:" required>
        </div>
        
        <div class="input-container">
            <input type="text" id="funcao" name="funcao" placeholder="Cargo/Job title:" required>
        </div>
        
        <div class="input-container">
            <input type="text" id="segmento" name="segmento" placeholder="Sector de Negocio/Type of Business:" required>
        </div>

        <div class="input-container">
            <input type="email" id="email" name="email" placeholder="E-mail:" required>
        </div>

        <!-- Checkbox -->
        <div class="checkbox-container">
            <input type="checkbox" id="lgpd" name="lgpd" required>
            <label for="lgpd" class="checkbox-label">
                I accept that 1XBET uses my data.<br>
                Acepto que 1XBET use mis datos.
            </label>
        </div>

        <div>
            <button type="submit" id="submit-button">Enviar/Submit</button>
        </div>  
    </form>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            console.log("Cadastro JavaScript loaded!");

            const form = document.getElementById("form");

            // Add submit event listener to the form
            form.addEventListener("submit", async function (event) {
                event.preventDefault(); // Prevent default form submission
                console.log("Submit button clicked!");

                // Get form field values
                const nome = document.getElementById("nome").value;
                const empresa = document.getElementById("empresa").value;
                const funcao = document.getElementById("funcao").value;
                const segmento = document.getElementById("segmento").value;
                const email = document.getElementById("email").value;
                const lgpd = document.getElementById("lgpd").checked;

                try {
                    // Send POST request to backend
                    const response = await fetch("/api/cadastro", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({ nome, empresa, funcao, segmento, email, lgpd })
                    });

                    if (!response.ok) {
                        throw new Error("Error during registration: " + response.statusText);
                    }

                    const resultado = await response.json();
                    console.log(resultado);

                    // Redirect if registration was successful
                    if (resultado.success) {
                        console.log("Redirecting to confirmation page...");
                        window.location.href = "/confirmacao";
                    } else {
                        alert("Registration failed.");
                    }

                } catch (error) {
                    console.error("Error sending data:", error);
                    alert("Error connecting to the server.");
                }
            });
        });
    </script>
</body>
</html>
